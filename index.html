<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airplane Game</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=UnifrakturMaguntia">

<style>
        body { margin: 0; font-family: "Sofia", sans-serif;}
        canvas { display: block; background: #ee82ee; }
        #game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10em;
            color: white;
            background: rgba(0, 230, 255, 0.8);
            padding: 20px;
			font-family: "UnifrakturMaguntia";
        }
		#lives-counter {
			position: absolute;
			top: 10px;
			right: 100px;
			color: white;
			font-size: 1.5em;
			background: rgba(0, 0, 0, 0.5);
			padding: 10px;
			border-radius: 5px;
			width: 1000px;
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="game-over">Game Over</div>
    <div id="lives-counter"> Lives: 3</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const gameOverDiv = document.getElementById('game-over');
        canvas.width = window.innerWidth - 20;
        canvas.height = window.innerHeight - 20;

        const img = new Image();
        img.src = "https://github.com/filipp7/sandbox/blob/main/airplane.png";  // Ensure airplane.png is in the same directory

        const meteoriteImg = new Image();
        meteoriteImg.src = "https://github.com/filipp7/sandbox/blob/main/airplane.png";  // Ensure meteorite.png is in the same directory

        let x = canvas.width / 2, y = canvas.height / 2, speed = 5;
        let keys = {};
        let facingRight = true;
        let lives = 3;
        let gameActive = true;
		let distance = 0;

        const meteorites = [];
        const meteoriteSize = 50;
        const meteoriteSpeed = 3;

        function generateMeteorite() {
            const x = Math.random() * (canvas.width - meteoriteSize);
            meteorites.push({ x: x, y: -meteoriteSize });
        }

        function drawMeteorite(meteorite) {
            ctx.drawImage(meteoriteImg, meteorite.x, meteorite.y, meteoriteSize, meteoriteSize);
        }

        function updateMeteorites() {
            for (let i = meteorites.length - 1; i >= 0; i--) {
                meteorites[i].y += meteoriteSpeed;
                if (meteorites[i].y > canvas.height) {
                    meteorites.splice(i, 1);
                } else if (checkCollision(meteorites[i])) {
                    meteorites.splice(i, 1);
                    lives -= 1;
					document.getElementById('lives-counter').textContent = `Plane lives matter: ${lives}`
                    if (lives <= 0) {
                        gameActive = false;
                        gameOverDiv.style.display = 'block';
                    }
                }
            }
        }

        function checkCollision(meteorite) {
            const dx = x - meteorite.x;
            const dy = y - meteorite.y;
            return (dx < meteoriteSize && dx > -meteoriteSize) && (dy < meteoriteSize && dy > -meteoriteSize);
        }

        img.onload = () => {
            function draw() {
                if (!gameActive) return;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw airplane
                ctx.save();
                if (!facingRight) {
                    ctx.scale(-1, 1);
                    ctx.drawImage(img, -x - 50, y, 50, 50);
                } else {
                    ctx.drawImage(img, x, y, 50, 50);
                }
                ctx.restore();

                // Draw meteorites
                meteorites.forEach(drawMeteorite);

                // Update meteorites
                updateMeteorites();

                // Update airplane position
                if (keys['ArrowRight']) {
                    x += speed;
                    facingRight = true;
					distance = distance + speed;
					if( distance > 800 ) {
						lives += 1;
						document.getElementById('lives-counter').textContent = `Plane lives matter: ${lives}`;
						distance = 0;
					}
                }
                if (keys['ArrowLeft']) {
                    x -= speed;
                    facingRight = false;
					distance = distance + speed;
					if( distance > 800 ) {
						lives += 1;
						document.getElementById('lives-counter').textContent = `Plane lives matter: ${lives}`;
						distance = 0;
					}
                }
                if (keys['ArrowUp']) y -= speed;
                if (keys['ArrowDown']) y += speed;

                requestAnimationFrame(draw);
            }

            draw();
        };

        window.addEventListener('keydown', (e) => keys[e.key] = true);
        window.addEventListener('keyup', (e) => keys[e.key] = false);

        setInterval(generateMeteorite, 100);
    </script>
</body>
</html>

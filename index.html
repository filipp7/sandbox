<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airplane Game</title>
    <style>
        body { margin: 0; }
        canvas { display: block; background: #000; }
        #life-count {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 1.5em;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
        }
        #game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="life-count">Lives: 3</div>
    <div id="game-over">Game Over</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const gameOverDiv = document.getElementById('game-over');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const img = new Image();
        img.src = './airplane.png';  // Ensure airplane.png is in the same directory

        const meteoriteImg = new Image();
        meteoriteImg.src = './meteorite.png';  // Ensure meteorite.png is in the same directory

        let x = canvas.width / 2, y = canvas.height / 2, speed = 5;
        let keys = {};
        let facingRight = true;
        let lives = 3;
        let gameActive = true;
        let touchStartX = null;

        const meteorites = [];
        const meteoriteSize = 50;
        const meteoriteSpeed = 3;

        function generateMeteorite() {
            const x = Math.random() * (canvas.width - meteoriteSize);
            meteorites.push({ x: x, y: -meteoriteSize });
        }

        function drawMeteorite(meteorite) {
            ctx.drawImage(meteoriteImg, meteorite.x, meteorite.y, meteoriteSize, meteoriteSize);
        }

        function updateMeteorites() {
            for (let i = meteorites.length - 1; i >= 0; i--) {
                meteorites[i].y += meteoriteSpeed;
                if (meteorites[i].y > canvas.height) {
                    meteorites.splice(i, 1);
                } else if (checkCollision(meteorites[i])) {
                    meteorites.splice(i, 1);
                    lives -= 1;
                    document.getElementById('life-count').innerHTML = Lives: ${lives}<br>Be careful!;
                    if (lives <= 0) {
                        gameActive = false;
                        gameOverDiv.style.display = 'block';
                    }
                }
            }
        }

        function checkCollision(meteorite) {
            const dx = x - meteorite.x;
            const dy = y - meteorite.y;
            return (dx < meteoriteSize && dx > -meteoriteSize) && (dy < meteoriteSize && dy > -meteoriteSize);
        }

        img.onload = () => {
            document.getElementById('life-count').innerHTML = Lives: ${lives}<br>Be careful!;
            function draw() {
                if (!gameActive) return;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw airplane
                ctx.save();
                if (!facingRight) {
                    ctx.scale(-1, 1);
                    ctx.drawImage(img, -x - 50, y, 50, 50);
                } else {
                    ctx.drawImage(img, x, y, 50, 50);
                }
                ctx.restore();

                // Draw meteorites
                meteorites.forEach(drawMeteorite);

                // Update meteorites
                updateMeteorites();

                // Update airplane position
                if (keys['ArrowRight']) {
                    x += speed;
                    facingRight = true;
                }
                if (keys['ArrowLeft']) {
                    x -= speed;
                    facingRight = false;
                }
                if (keys['ArrowUp']) y -= speed;
                if (keys['ArrowDown']) y += speed;

                requestAnimationFrame(draw);
            }

            draw();
        };

        window.addEventListener('keydown', (e) => keys[e.key] = true);
        window.addEventListener('keyup', (e) => keys[e.key] = false);

        // Add touch event listeners
        canvas.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            touchStartX = touch.clientX;
        });

        canvas.addEventListener('touchmove', (e) => {
            if (!touchStartX) return;
            const touch = e.touches[0];
            const touchMoveX = touch.clientX;
            if (touchMoveX > touchStartX) {
                x += speed;
                facingRight = true;
            } else if (touchMoveX < touchStartX) {
                x -= speed;
                facingRight = false;
            }
            touchStartX = touchMoveX;  // Update start position to current
        });

        canvas.addEventListener('touchend', () => {
            touchStartX = null;
        });

        setInterval(generateMeteorite, 1000);
    </script>
</body>
</html>
